<div class="container mt-4 formularioCrear">
  <h2>Crear nueva tarea</h2>
  <form [formGroup]="formulario" (ngSubmit)="enviar()">
    <div class="mb-3">
      <label for="Titulo" class="form-label">Título</label>
      <input type="text" id="Titulo" formControlName="Titulo" class="form-control" />
      <div class="text-danger" *ngIf="tieneErrores('Titulo', 'required')">
        Campo obligatorio
      </div>
    </div>

    <div class="mb-3">
      <label for="Prioridad" class="form-label">Prioridad</label>
      <select id="Prioridad" formControlName="Prioridad" class="form-select">
        <option value="Baja">Baja</option>
        <option value="Media">Media</option>
        <option value="Alta">Alta</option>
      </select>
    </div>

    <div class="mb-3">
      <label for="Estado" class="form-label">Estado</label>
      <select id="Estado" formControlName="Estado" class="form-select">
        <option value="Pendiente">Pendiente</option>
        <option value="En Desarrollo">En Desarrollo</option>
        <option value="Finalizado">Finalizado</option>
      </select>
    </div>

    <div class="row">
      <div class="col-md-6 mb-3">
        <label for="FechaInicio" class="form-label">Fecha de inicio</label>
        <input type="date" id="FechaInicio" formControlName="FechaInicio" class="form-control" />
      </div>
      <div class="col-md-6 mb-3">
        <label for="FechaFin" class="form-label">Fecha de fin</label>
        <input type="date" id="FechaFin" formControlName="FechaFin" class="form-control" />
      </div>
    </div>

    <div class="mb-3">
      <label class="form-label">Pasos</label>
      <div formArrayName="Pasos">
        <div *ngFor="let paso of pasos.controls; let i = index" class="d-flex mb-2">
          <input [formControlName]="i" type="text" class="form-control me-2" placeholder="Descripción del paso" />
          <button type="button" class="btn btn-outline-danger btn-sm" (click)="eliminarPaso(i)" *ngIf="pasos.length > 1">
            ✕
          </button>
        </div>
      </div>
      <button type="button" class="btn btn-outline-secondary btn-sm" (click)="agregarPaso()">+ Agregar paso</button>
    </div>

    <button type="submit" class="btn btn-primary mt-3" [disabled]="formulario.invalid || cargando">
      {{ cargando ? 'Creando...' : 'Crear tarea' }}
    </button>
  </form>

  <div *ngIf="alerta" class="alert alert-success mt-3">
    La tarea "{{ formulario.value.Titulo }}" fue creada con éxito.
  </div>

  <div *ngIf="error" class="alert alert-danger mt-3">
    Hubo un error al crear la tarea. Inténtalo nuevamente.
  </div>
</div>
